2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_setup.py:_flush():76] Configure stats pid to 44081
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_setup.py:_flush():76] Loading settings from /Users/briansu/.config/wandb/settings
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_setup.py:_flush():76] Loading settings from /Users/briansu/workspace/mamp_prediction_ml/wandb/settings
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': '06_scripts_ml/06_main_train.py', 'program': '/Users/briansu/workspace/mamp_prediction_ml/06_scripts_ml/06_main_train.py'}
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_init.py:_log_setup():461] Logging user logs to ../model_results/esm2_bfactor_weighted_05_datasets/wandb/run-20250514_205404-2g9k4d6h/logs/debug.log
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_init.py:_log_setup():462] Logging internal logs to ../model_results/esm2_bfactor_weighted_05_datasets/wandb/run-20250514_205404-2g9k4d6h/logs/debug-internal.log
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_init.py:init():495] calling init triggers
2025-05-14 20:54:04,111 INFO    MainThread:44081 [wandb_init.py:init():498] wandb.init called with sweep_config: {}
config: {'seed': 0, 'debug': '', 'repeat_thresh': 0.001, 'n_fed_cats': -1, 'detic_path': PosixPath('/path/to/file'), 'pos_thresh': 0.5, 'aa_expand': 'scratch', 'single_dec': 'naive', 'head_dim': 128, 'backbone': 'esm2_t33_650M_UR50D', 'finetune_backbone': '/scratch/cluster/jozhang/models/openfold_params/finetuning_ptm_2.pt', 'freeze_at': 14, 'model': 'esm2_bfactor_weighted', 'data_dir': '05_datasets', 'eval_only_data_path': None, 'n_msa_seqs': 128, 'n_extra_msa_seqs': 1024, 'af_extract_feat': 'both', 'max_context_length': 2000, 'num_workers': 10, 'epochs': 20, 'batch_size': 8, 'lr': 0.0003, 'min_lr': 1e-09, 'weight_decay': 0.5, 'warmup_epochs': 10, 'cross_eval_kfold': None, 'lambda_single': 0.1, 'loss_single_aug': 'none', 'lambda_double': 1.0, 'double_subsample_destabilizing_ratio': 8, 'lambda_pos': 4, 'eval': False, 'dist_eval': False, 'eval_reverse': False, 'test': False, 'finetune': '', 'resume': '', 'start_epoch': 0, 'save_pred_dict': False, 'eval_period': 5, 'save_period': 10, 'disable_wandb': False, 'model_checkpoint_path': None, 'device': 'cpu', 'world_size': 1, 'name_to_x': '../out_data/colabfold_name_to_x.pt', 'local_rank': -1, 'dist_on_itp': False, 'dist_url': 'env://', 'contrastive_output': True, 'output_dir': PosixPath('../model_results/esm2_bfactor_weighted_05_datasets'), 'distributed': False}
2025-05-14 20:54:04,112 INFO    MainThread:44081 [wandb_init.py:init():548] starting backend
2025-05-14 20:54:04,112 INFO    MainThread:44081 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2025-05-14 20:54:04,132 INFO    MainThread:44081 [backend.py:ensure_launched():217] starting backend process...
2025-05-14 20:54:04,139 INFO    MainThread:44081 [backend.py:ensure_launched():222] started backend process with pid: 44117
2025-05-14 20:54:04,140 INFO    MainThread:44081 [wandb_init.py:init():558] backend started and connected
2025-05-14 20:54:04,150 INFO    MainThread:44081 [wandb_init.py:init():634] updated telemetry
2025-05-14 20:54:04,174 INFO    MainThread:44081 [wandb_init.py:init():665] communicating run to backend with 30 second timeout
2025-05-14 20:54:04,860 INFO    MainThread:44081 [wandb_run.py:_on_init():1919] communicating current version
2025-05-14 20:54:05,050 INFO    MainThread:44081 [wandb_run.py:_on_init():1923] got version response upgrade_message: "wandb version 0.19.11 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2025-05-14 20:54:05,050 INFO    MainThread:44081 [wandb_init.py:init():700] starting run threads in backend
2025-05-14 20:54:05,105 INFO    MainThread:44081 [wandb_run.py:_console_start():1893] atexit reg
2025-05-14 20:54:05,105 INFO    MainThread:44081 [wandb_run.py:_redirect():1766] redirect: SettingsConsole.REDIRECT
2025-05-14 20:54:05,105 INFO    MainThread:44081 [wandb_run.py:_redirect():1771] Redirecting console.
2025-05-14 20:54:05,106 INFO    MainThread:44081 [wandb_run.py:_redirect():1827] Redirects installed.
2025-05-14 20:54:05,106 INFO    MainThread:44081 [wandb_init.py:init():732] run started, returning control to user process
2025-05-15 08:07:56,355 INFO    MainThread:44081 [wandb_run.py:_finish():1680] finishing run dmstev-uc-berkeley/mamp_ml/2g9k4d6h
2025-05-15 08:07:56,355 INFO    MainThread:44081 [wandb_run.py:_atexit_cleanup():1862] got exitcode: 0
2025-05-15 08:07:56,361 INFO    MainThread:44081 [wandb_run.py:_restore():1834] restore
2025-05-15 08:07:58,699 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 1016
  total_bytes: 1016
}

2025-05-15 08:08:00,035 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 1016
  total_bytes: 1016
}

2025-05-15 08:08:00,283 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 1016
  total_bytes: 1016
}

2025-05-15 08:08:01,112 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 1016
  total_bytes: 1016
}

2025-05-15 08:08:01,218 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 1016
  total_bytes: 151999
}

2025-05-15 08:08:01,323 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 1016
  total_bytes: 151999
}

2025-05-15 08:08:01,430 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:01,538 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:01,643 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:01,749 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:01,857 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:01,965 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,068 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,171 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,276 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,379 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,481 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,589 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,693 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,797 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:02,900 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,005 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,107 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,210 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,315 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,423 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,531 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,637 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,740 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,847 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:03,956 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:04,063 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:04,175 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 150472
  total_bytes: 151999
}

2025-05-15 08:08:04,278 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 151999
  total_bytes: 151999
}

2025-05-15 08:08:04,381 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 151999
  total_bytes: 151999
}

2025-05-15 08:08:04,485 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 151999
  total_bytes: 151999
}

2025-05-15 08:08:04,593 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 151999
  total_bytes: 151999
}

2025-05-15 08:08:05,044 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 151999
  total_bytes: 151999
}

2025-05-15 08:08:05,347 INFO    MainThread:44081 [wandb_run.py:_on_finish():1991] got exit ret: done: true
exit_result {
}
file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 151999
  total_bytes: 151999
}
local_info {
}

2025-05-15 08:08:06,471 INFO    MainThread:44081 [wandb_run.py:_footer_history_summary_info():3099] rendering history
2025-05-15 08:08:06,472 INFO    MainThread:44081 [wandb_run.py:_footer_history_summary_info():3131] rendering summary
2025-05-15 08:08:06,475 INFO    MainThread:44081 [wandb_run.py:_footer_sync_info():3055] logging synced files
